<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù†Ø¸Ø§Ù… ØªÙØµÙŠÙ„ Ø§Ù„Ù‚Ù…ØµØ§Ù† (Sur Mesure)</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #c0392b;
            --bg-color: #f3f5f7;
            --info-bg: #fff8e1;
            --info-text: #856404;
            --shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        body { 
            background-color: var(--bg-color); 
            color: #333; 
            line-height: 1.6; 
            padding: 15px; 
            direction: rtl; 
        }
        
        .container {
            max-width: 1200px; 
            margin: 0 auto; 
            background-color: white;
            border-radius: 16px; 
            box-shadow: var(--shadow); 
            padding: 25px;
            overflow: hidden; /* Ù„Ù…Ù†Ø¹ Ø£ÙŠ ØªÙ…Ø¯Ø¯ Ø®Ø§Ø±Ø¬ Ø§Ù„Ø¥Ø·Ø§Ø± */
        }
        
        header { 
            text-align: center; 
            margin-bottom: 25px; 
            border-bottom: 2px solid #eee; 
            padding-bottom: 15px; 
        }
        
        h1 { color: var(--primary-color); font-size: 1.8rem; margin-bottom: 8px; }
        .subtitle { color: #7f8c8d; font-size: 1rem; }
        
        /* ØªØ®Ø·ÙŠØ· Ù…Ø±Ù† ÙŠØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª */
        .main-content { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 25px; 
            align-items: flex-start;
        }
        
        /* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠÙ…Ù†: Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
        .measurements-form {
            flex: 1; 
            min-width: 320px; 
            background-color: #fff;
        }
        
        /* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠØ³Ø±: Ø§Ù„Ø±Ø³Ù… */
        .shirt-display {
            flex: 1.5; 
            min-width: 320px; 
            background: #fdfdfd; 
            border-radius: 12px; 
            border: 1px solid #eee;
            padding: 15px;
            position: sticky;
            top: 20px; /* ÙŠØ«Ø¨Øª Ø§Ù„Ø±Ø³Ù… Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø³Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª */
        .instructions-box {
            background-color: var(--info-bg);
            color: var(--info-text);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #ffeeba;
            margin-bottom: 25px;
            font-size: 0.95rem;
        }
        
        .instructions-box summary {
            font-weight: bold;
            cursor: pointer;
            padding: 5px;
            outline: none;
            list-style: none;
            display: flex; align-items: center; justify-content: space-between;
        }
        .instructions-box summary::after { content: "â–¼"; font-size: 0.8em; transition: 0.3s; }
        .instructions-box[open] summary::after { transform: rotate(180deg); }
        
        .tips-list { margin-top: 15px; padding-right: 20px; font-size: 0.9em; }
        .tips-list li { margin-bottom: 8px; }
        
        /* Ø§Ù„Ø­Ù‚ÙˆÙ„ */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
        }

        .form-group { margin-bottom: 0; } /* Ø§Ù„Ù…Ø³Ø§ÙØ© ÙŠØªØ­ÙƒÙ… Ø¨Ù‡Ø§ Ø§Ù„ØºØ±ÙŠØ¯ */
        .form-group.full-width { grid-column: 1 / -1; }

        label { 
            display: block; 
            margin-bottom: 6px; 
            font-weight: 600; 
            color: var(--primary-color); 
            font-size: 0.9rem; 
        }
        
        input[type="number"] {
            width: 100%; 
            padding: 12px 15px; 
            border: 2px solid #e0e0e0;
            border-radius: 10px; 
            font-size: 16px; /* Ø­Ø¬Ù… 16 ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø²ÙˆÙˆÙ… ÙÙŠ Ø§Ù„Ø¢ÙŠÙÙˆÙ† */
            transition: 0.2s;
            background-color: #fbfbfb;
            appearance: none; -moz-appearance: none; /* Ø¥Ø®ÙØ§Ø¡ Ø£Ø³Ù‡Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© */
        }
        
        input[type="number"]:focus { 
            border-color: var(--primary-color); 
            background-color: #fff; 
            box-shadow: 0 0 0 3px rgba(44, 62, 80, 0.1);
            outline: none; 
        }
        
        .unit { color: #95a5a6; font-size: 0.75em; display: block; margin-top: 2px; font-weight: normal; }
        
        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn-group { 
            display: flex; 
            gap: 12px; 
            margin-top: 25px; 
            grid-column: 1 / -1;
        }
        
        .btn {
            flex: 1; 
            padding: 14px; 
            border: none; 
            border-radius: 10px;
            cursor: pointer; 
            font-size: 16px; 
            font-weight: bold; 
            transition: 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .btn:active { transform: scale(0.98); }
        
        .btn-primary { background-color: var(--primary-color); color: white; }
        .btn-primary:hover { background-color: #1a252f; }
        
        .btn-download { background-color: var(--accent-color); color: white; }
        .btn-download:hover { background-color: #a93226; }
        
        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø³Ù… */
        .canvas-container {
            width: 100%; 
            height: 550px; 
            background-color: white;
            border-radius: 10px; 
            overflow: hidden; 
            position: relative;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.03);
        }
        
        #shirtCanvas { width: 100%; height: 100%; display: block; }

        /* =========================================
           Media Queries - Ø³Ø± Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©
           ========================================= */
        
        /* Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„ÙˆØ­ÙŠØ© ÙˆØ§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ (Ø£Ù‚Ù„ Ù…Ù† 900px) */
        @media (max-width: 900px) {
            .container { padding: 15px; width: 100%; margin: 0; border-radius: 0; box-shadow: none; }
            body { padding: 0; background-color: white; }
            .main-content { flex-direction: column; gap: 30px; }
            .measurements-form, .shirt-display { min-width: 100%; flex: 1; }
            .shirt-display { order: -1; /* Ø±ÙØ¹ Ø§Ù„Ø±Ø³Ù… Ù„Ù„Ø£Ø¹Ù„Ù‰ ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù„ÙŠØ±Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙˆØ±Ø§Ù‹ */ position: relative; top: 0; padding: 0; border: none; }
            .canvas-container { height: 350px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø±Ø³Ù… ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */ }
            h1 { font-size: 1.5rem; }
            .form-grid { grid-template-columns: 1fr 1fr; /* Ø­Ù‚Ù„ÙŠÙ† ÙÙŠ Ø§Ù„ØµÙ */ }
        }

        /* Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø§Ù„ØµØºÙŠØ± Ø¬Ø¯Ø§Ù‹ (Ø£Ù‚Ù„ Ù…Ù† 400px) */
        @media (max-width: 400px) {
            .form-grid { grid-template-columns: 1fr; /* Ø­Ù‚Ù„ ÙˆØ§Ø­Ø¯ ÙÙŠ Ø§Ù„ØµÙ */ }
            .btn-group { flex-direction: column; }
            .canvas-container { height: 300px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ù†Ø¸Ø§Ù… ØªÙØµÙŠÙ„ Ø§Ù„Ù‚Ù…ØµØ§Ù†</h1>
            <p class="subtitle">Ø£Ø¯Ø®Ù„ Ù‚ÙŠØ§Ø³Ø§ØªÙƒ ÙˆØ³Ù†Ù‚ÙˆÙ… Ø¨Ø±Ø³Ù… Ø§Ù„Ø¨Ø§ØªØ±ÙˆÙ† Ø¨Ø¯Ù‚Ø©</p>
        </header>
        
        <div class="main-content">
            <div class="measurements-form">
                
                <details class="instructions-box">
                    <summary>ğŸ“ Ø§Ø¶ØºØ· Ù‡Ù†Ø§: ÙƒÙŠÙ ØªÙ‚ÙŠØ³ Ø¨Ø¯Ù‚Ø©ØŸ</summary>
                    <ul class="tips-list">
                        <li><strong>ğŸ’¡ Ù†ØµÙŠØ­Ø© Ø°Ù‡Ø¨ÙŠØ©:</strong> Ø§Ø·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø© ØµØ¯ÙŠÙ‚ØŒ Ù„Ø§ ØªÙ‚ÙØ³ Ù†ÙØ³Ùƒ Ø¨Ù†ÙØ³Ùƒ.</li>
                        <li><strong>1. Ø§Ù„Ø±Ù‚Ø¨Ø©:</strong> Ø­ÙˆÙ„ Ø£Ø³ÙÙ„ Ø§Ù„Ø±Ù‚Ø¨Ø© + Ø¥ØµØ¨Ø¹ Ø±Ø§Ø­Ø©.</li>
                        <li><strong>2. Ø§Ù„ÙƒØªÙ:</strong> Ù…Ù† Ø¹Ø¸Ù…Ø© Ø§Ù„ÙƒØªÙ Ù„Ù„ÙŠÙ…Ù† Ù„Ù„ÙŠØ³Ø±Ù‰ (Ù…Ù† Ø§Ù„Ø®Ù„Ù).</li>
                        <li><strong>3. Ø§Ù„ØµØ¯Ø±:</strong> ØªØ­Øª Ø§Ù„Ø¥Ø¨Ø·ÙŠÙ† (Ø£Ø¹Ø±Ø¶ Ù…Ù†Ø·Ù‚Ø©) ÙˆØ§Ù„Ù…ØªØ± Ù…Ø±ØªØ§Ø­.</li>
                        <li><strong>4. Ø§Ù„ÙƒØ±Ø´:</strong> Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø±Ø© ØªÙ…Ø§Ù…Ø§Ù‹ (Ø¨Ø¯ÙˆÙ† Ø´ÙØ· Ø§Ù„Ø¨Ø·Ù†!).</li>
                        <li><strong>5. Ø§Ù„Ø°Ø±Ø§Ø¹:</strong> Ù…Ù† Ø¹Ø¸Ù…Ø© Ø§Ù„ÙƒØªÙ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¹ØµÙ….</li>
                        <li><strong>6. Ø§Ù„Ø¹Ø¶Ù„Ø©:</strong> Ø­ÙˆÙ„ Ø£Ø¶Ø®Ù… Ù…Ù†Ø·Ù‚Ø© ÙÙŠ Ø§Ù„Ø°Ø±Ø§Ø¹.</li>
                    </ul>
                </details>

                <div class="form-grid">
                    <div class="form-group">
                        <label>Ø¹Ø±Ø¶ Ø§Ù„ÙƒØªÙ <span class="unit">(Ø³Ù…)</span></label>
                        <input type="number" id="shoulder" value="46" placeholder="46">
                    </div>
                    
                    <div class="form-group">
                        <label>Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ø±Ù‚Ø¨Ø© <span class="unit">(Ø³Ù…)</span></label>
                        <input type="number" id="neck" value="42" placeholder="42">
                    </div>
                    
                    <div class="form-group">
                        <label>Ø·ÙˆÙ„ Ø§Ù„Ø°Ø±Ø§Ø¹ <span class="unit">(Ø³Ù…)</span></label>
                        <input type="number" id="armLength" value="62" placeholder="62">
                    </div>
                    
                    <div class="form-group">
                        <label>Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ø°Ø±Ø§Ø¹ <span class="unit">(Ø³Ù…)</span></label>
                        <input type="number" id="armCircle" value="38" placeholder="38">
                    </div>
                    
                    <div class="form-group">
                        <label>Ù…Ø­ÙŠØ· Ø§Ù„ØµØ¯Ø± <span class="unit">(Ø³Ù…)</span></label>
                        <input type="number" id="chest" value="104" placeholder="104">
                    </div>

                    <div class="form-group">
                        <label>Ù…Ø­ÙŠØ· Ø§Ù„ÙƒØ±Ø´ <span class="unit">(Ø³Ù…)</span></label>
                        <input type="number" id="waist" value="96" placeholder="96">
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Ø§Ù„Ø·ÙˆÙ„ Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ù‚Ù…ÙŠØµ <span class="unit">(Ù…Ù† Ø§Ù„ÙƒØªÙ Ù„Ù„Ø£Ø³ÙÙ„)</span></label>
                        <input type="number" id="shoulderToNavel" value="75" placeholder="75">
                    </div>
                </div>
                
                <div class="btn-group">
                    <button id="generateBtn" class="btn btn-primary">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… â†»</button>
                    <button id="downloadBtn" class="btn btn-download">Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© ğŸ“¥</button>
                </div>
            </div>
            
            <div class="shirt-display">
                <div class="canvas-container">
                    <canvas id="shirtCanvas"></canvas>
                </div>
            </div>
        </div>
        
        <footer>
            <p style="text-align: center; margin-top: 20px; color: #aaa; font-size: 0.8em;">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØºÙ„ Â© 2024</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('shirtCanvas');
            const ctx = canvas.getContext('2d');
            
            // Ø¯Ø§Ù„Ø© Ø¶Ø¨Ø· Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ Ù„ØªÙƒÙˆÙ† Ù…ØªØ¬Ø§ÙˆØ¨Ø©
            function resizeCanvas() {
                const container = canvas.parentElement;
                // Ù†Ø³ØªØ®Ø¯Ù… Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠ
                const width = container.clientWidth;
                const height = container.clientHeight;

                // Ø²ÙŠØ§Ø¯Ø© Ø¯Ù‚Ø© Ø§Ù„Ø¨ÙƒØ³Ù„ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¯Ù‚Ø© (Retina)
                canvas.width = width * 2;
                canvas.height = height * 2;
                
                // Ø¶Ø¨Ø· Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø¸Ø§Ù‡Ø±ÙŠ ÙÙŠ CSS
                canvas.style.width = width + "px";
                canvas.style.height = height + "px";
                
                // Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¯Ø§Ø®Ù„ Ø§Ù„Ø±Ø³Ù…
                ctx.scale(2, 2);
                
                drawShirt();
            }
            
            function getInputs() {
                return {
                    shoulder: parseFloat(document.getElementById('shoulder').value) || 45,
                    neck: parseFloat(document.getElementById('neck').value) || 40,
                    armLength: parseFloat(document.getElementById('armLength').value) || 60,
                    armCircle: parseFloat(document.getElementById('armCircle').value) || 35,
                    chest: parseFloat(document.getElementById('chest').value) || 100,
                    waist: parseFloat(document.getElementById('waist').value) || 90,
                    length: parseFloat(document.getElementById('shoulderToNavel').value) || 70
                };
            }

            function drawShirt() {
                const m = getInputs();
                // Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„ÙƒØ§Ù†ÙØ§Ø³ (Ù…Ù‚Ø³ÙˆÙ…Ø© Ø¹Ù„Ù‰ 2 Ù„Ø£Ù†Ù†Ø§ Ø¹Ù…Ù„Ù†Ø§ scale)
                const w = canvas.width / 2;
                const h = canvas.height / 2;
                
                ctx.fillStyle = "white";
                ctx.fillRect(0, 0, w, h);
                
                const cx = w / 2;
                // Ø¶Ø¨Ø· Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø´Ø§Ø´Ø©
                const topY = h * 0.1; // 10% Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰
                
                // Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù„ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„Ø´Ø§Ø´Ø©
                // ÙƒÙ„Ù…Ø§ ÙƒØ¨Ø±Øª Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø£Ùˆ ØµØºØ±Øª Ø§Ù„Ø´Ø§Ø´Ø©ØŒ ÙŠØªØºÙŠØ± Ø§Ù„Ø­Ø¬Ù…
                const maxBodyWidth = Math.max(m.chest, m.waist, m.shoulder * 1.5);
                const totalHeight = m.length + 40; // Ø§Ù„Ø·ÙˆÙ„ + Ø§Ù„Ø±Ù‚Ø¨Ø©
                
                // Ù…Ø¹Ø§Ø¯Ù„Ø© Ù„Ø­Ø³Ø§Ø¨ Ø£ÙØ¶Ù„ Zoom
                const scaleX = (w * 0.7) / (maxBodyWidth / 2); // Ø§Ø³ØªØºÙ„Ø§Ù„ 70% Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶
                const scaleY = (h * 0.8) / totalHeight;        // Ø§Ø³ØªØºÙ„Ø§Ù„ 80% Ù…Ù† Ø§Ù„Ø·ÙˆÙ„
                const scale = Math.min(scaleX, scaleY); // Ù†Ø£Ø®Ø° Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£Ù‚Ù„ Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø±Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„

                const shoulderPx = (m.shoulder / 2) * scale;
                const neckPx = (m.neck / 6) * scale; 
                const chestPx = (m.chest / 4) * scale; 
                const waistPx = (m.waist / 4) * scale; 
                const lengthPx = m.length * scale;
                const armLenPx = m.armLength * scale;
                const armWidthPx = (m.armCircle / 2) * scale;

                ctx.strokeStyle = "#2c3e50";
                ctx.lineWidth = 2;
                ctx.lineCap = "round";
                ctx.lineJoin = "round";

                // --- Ø±Ø³Ù… Ø§Ù„Ø¬Ø³Ù… ---
                ctx.beginPath();
                ctx.fillStyle = "#eaf2f8"; 
                ctx.moveTo(cx - neckPx, topY);
                ctx.quadraticCurveTo(cx, topY + (neckPx/1.5), cx + neckPx, topY); 
                ctx.lineTo(cx + shoulderPx, topY + (15 * scale/3.5)); // Ù…ÙŠÙ„Ø§Ù† Ø§Ù„ÙƒØªÙ Ù…ØªÙ†Ø§Ø³Ø¨
                ctx.quadraticCurveTo(cx + chestPx, topY + (50 * scale/3.5), cx + chestPx, topY + (100 * scale/3.5)); 
                ctx.lineTo(cx + waistPx, topY + lengthPx); 
                ctx.quadraticCurveTo(cx, topY + lengthPx + (10 * scale/3.5), cx - waistPx, topY + lengthPx); 
                ctx.lineTo(cx - chestPx, topY + (100 * scale/3.5)); 
                ctx.quadraticCurveTo(cx - chestPx, topY + (50 * scale/3.5), cx - shoulderPx, topY + (15 * scale/3.5)); 
                ctx.lineTo(cx - neckPx, topY);
                ctx.fill();
                ctx.stroke();

                // --- Ø±Ø³Ù… Ø§Ù„Ø£ÙƒÙ…Ø§Ù… ---
                ctx.fillStyle = "#d6eaf8"; 
                
                // Ø§Ù„ÙƒÙ… Ø§Ù„Ø£ÙŠÙ…Ù†
                const rShoulderX = cx + shoulderPx;
                const rShoulderY = topY + (15 * scale/3.5);
                // Ø²Ø§ÙˆÙŠØ© Ø§Ù„ÙƒÙ… Ù„Ø£Ø³ÙÙ„ Ù‚Ù„ÙŠÙ„Ø§Ù‹
                const rWristX = rShoulderX + (armLenPx * 0.85); 
                const rWristY = rShoulderY + (armLenPx * 0.4);

                ctx.beginPath();
                ctx.moveTo(rShoulderX, rShoulderY);
                ctx.lineTo(rWristX, rWristY); 
                ctx.lineTo(rWristX - (5 * scale/3.5), rWristY + (armWidthPx*0.6));
                ctx.lineTo(cx + chestPx, topY + (80 * scale/3.5));
                ctx.fill(); 
                ctx.stroke();

                // Ø§Ù„ÙƒÙ… Ø§Ù„Ø£ÙŠØ³Ø±
                ctx.beginPath();
                ctx.moveTo(cx - shoulderPx, topY + (15 * scale/3.5));
                ctx.lineTo(cx - shoulderPx - (armLenPx * 0.85), topY + (15 * scale/3.5) + (armLenPx * 0.4));
                ctx.lineTo(cx - shoulderPx - (armLenPx * 0.8), topY + (15 * scale/3.5) + (armLenPx * 0.4) + (armWidthPx*0.6));
                ctx.lineTo(cx - chestPx, topY + (80 * scale/3.5));
                ctx.fill();
                ctx.stroke();

                // --- Ø®Ø·ÙˆØ· Ø§Ù„Ù‚ÙŠØ§Ø³ ---
                // ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø²Ø§Ø­Ø§Øª Ù„ØªÙƒÙˆÙ† Ù†Ø³Ø¨ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ scale
                drawDimensionLine(cx - shoulderPx, topY - (20 * scale/3.5), cx + shoulderPx, topY - (20 * scale/3.5), `Ø§Ù„ÙƒØªÙ: ${m.shoulder}`);
                drawDimensionLine(cx - neckPx, topY - 5, cx + neckPx, topY - 5, `Ø§Ù„Ø±Ù‚Ø¨Ø©: ${m.neck}`);
                
                const chestLineY = topY + (105 * scale/3.5);
                drawDimensionLine(cx - chestPx, chestLineY, cx + chestPx, chestLineY, `Ø§Ù„ØµØ¯Ø±: ${m.chest}`);

                const waistLineY = topY + lengthPx - (40 * scale/3.5);
                drawDimensionLine(cx - waistPx, waistLineY, cx + waistPx, waistLineY, `Ø§Ù„ÙƒØ±Ø´: ${m.waist}`);

                drawDimensionLine(cx - shoulderPx - (30 * scale/3.5), topY + (15 * scale/3.5), cx - shoulderPx - (30 * scale/3.5), topY + lengthPx, `Ø§Ù„Ø·ÙˆÙ„: ${m.length}`);

                drawDimensionLine(rShoulderX, rShoulderY - 10, rWristX, rWristY - 10, `Ø§Ù„Ø°Ø±Ø§Ø¹: ${m.armLength}`);

                const bicepX = rShoulderX + (rWristX - rShoulderX) * 0.3;
                const bicepY = rShoulderY + (rWristY - rShoulderY) * 0.3;
                // ØªØµØ­ÙŠØ­ Ø²Ø§ÙˆÙŠØ© Ø®Ø· Ø§Ù„Ø¹Ø¶Ù„Ø© Ù„ÙŠÙƒÙˆÙ† Ø¹Ù…ÙˆØ¯ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø°Ø±Ø§Ø¹
                drawDimensionLine(bicepX, bicepY, bicepX, bicepY + armWidthPx, `Ø¹Ø¶Ù„Ø©: ${m.armCircle}`);
            }

            function drawDimensionLine(x1, y1, x2, y2, text) {
                ctx.save();
                ctx.beginPath();
                ctx.strokeStyle = "#c0392b";
                ctx.fillStyle = "#c0392b";
                ctx.lineWidth = 1.5; // Ø®Ø· Ø£Ø³Ù…Ùƒ Ù‚Ù„ÙŠÙ„Ø§Ù‹
                
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.stroke();

                ctx.beginPath(); ctx.arc(x1, y1, 3, 0, Math.PI*2); ctx.fill();
                ctx.beginPath(); ctx.arc(x2, y2, 3, 0, Math.PI*2); ctx.fill();

                ctx.font = "bold 12px Tahoma"; // ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹
                ctx.textAlign = "center";
                
                const midX = (x1 + x2) / 2;
                const midY = (y1 + y2) / 2;
                
                const textWidth = ctx.measureText(text).width;
                ctx.fillStyle = "rgba(255,255,255,0.85)";
                ctx.fillRect(midX - textWidth/2 - 4, midY - 12, textWidth + 8, 16);
                
                ctx.fillStyle = "#c0392b";
                ctx.fillText(text, midX, midY);
                ctx.restore();
            }

            document.getElementById('generateBtn').addEventListener('click', drawShirt);
            document.querySelectorAll('input').forEach(i => i.addEventListener('input', drawShirt));

            document.getElementById('downloadBtn').addEventListener('click', function() {
                const link = document.createElement('a');
                link.download = `patron-${Date.now()}.jpg`;
                link.href = canvas.toDataURL('image/jpeg', 1.0);
                link.click();
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø© Ø£Ùˆ ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù‡Ø§ØªÙ
            window.addEventListener('resize', resizeCanvas);
            // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£Ø¨Ø¹Ø§Ø¯
            setTimeout(resizeCanvas, 100);
        });
    </script>
</body>
</html>
